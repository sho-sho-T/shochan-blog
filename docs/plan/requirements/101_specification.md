# 個人技術ブログ 要件定義書

## 📑 関連ドキュメント

- [技術スタック仕様書](../../003_teck_stack.md)
- [要件定義書作成ガイド](../rules/make-specification.md)
- [ディレクトリ構造](../../002_directory_structure.md) - ※コンテンツ管理方法の変更に伴い参照

## 📋 概要

個人の技術的な知見や学習内容を発信するためのブログシステム。
**コンテンツ（記事、画像）は Git リポジトリ内の Markdown ファイルと画像ファイルで管理し、Git Push をトリガーとして Vercel でデプロイ・公開される静的サイト**として構築する。

## 🎯 要求

- **コンテンツ管理**: 記事はリポジトリ内の指定されたディレクトリ (`src/content/posts/` 等) に配置された Markdown ファイル (`.md` or `.mdx`) として管理されること。
- **記事作成/編集**: 管理者（開発者）がローカル環境で Markdown ファイルを直接作成・編集し、Git でコミット・プッシュすること。
- **記事削除**: 対応する Markdown ファイルを Git リポジトリから削除し、プッシュすること。
- **記事情報**: Markdown ファイル内の Front Matter (YAML形式) で記事のメタデータ（タイトル、カテゴリ、タグ、公開日、公開状態など）を定義できること。
- **画像管理**: 記事で使用する画像は、記事ファイルと同じリポジトリ内の指定されたディレクトリ (`public/images/posts/` 等) で管理し、記事 Markdown から相対パスまたは絶対パスで参照できること。
- **カテゴリ/タグ**: 記事ファイルの Front Matter でカテゴリとタグを指定できること。サイト上ではカテゴリ別・タグ別の記事一覧が表示できること。
- **検索**: キーワード、カテゴリ、タグで記事を検索できること。
- **SEO**: 基本的なSEO対策が施されていること。

## 📝 機能仕様

### 4.1 記事管理（コンテンツ管理）

- **管理方法**: Git リポジトリ内の Markdown ファイル (`.md` or `.mdx`)。
- **配置場所**: `src/content/posts/` 以下（サブディレクトリによる整理も可能）。
- **記事情報 (Front Matter)**:
    - `title`: 記事タイトル (必須)
    - `publishedAt`: 公開日 (YYYY-MM-DD形式, 必須)
    - `updatedAt`: 更新日 (YYYY-MM-DD形式, 任意)
    - `status`: 公開状態 (`published` / `draft`, 必須, デフォルト: `draft`)
    - `excerpt`: 抜粋（概要, 任意）
    - `coverImage`: カバー画像のパス (任意, `public/` からの相対パス等)
    - `category`: カテゴリ名 (必須)
    - `tags`: タグ名の配列 (任意, 例: `['Next.js', 'TypeScript']`)
- **記事内容**: Front Matter 以降の Markdown/MDX 形式の本文。
- **公開フロー**: 管理者がローカルでファイルを作成/編集/削除 -> `git commit` -> `git push` -> Vercel が自動デプロイ -> サイトに反映。

### 4.2 画像管理

- **管理方法**: Git リポジトリ内の画像ファイル。
- **配置場所**: `public/images/posts/` 以下などを推奨（Next.js で直接配信可能なパス）。
- **参照方法**: Markdown ファイル内から `/images/posts/image.png` のような形式で参照。
- **操作**: 管理者がローカルで画像ファイルを追加/更新/削除し、Git で管理。

### 4.3 アクセス解析機能

- **本機能は実装しない** (閲覧数カウントは不要との判断)

### 4.4 カテゴリ機能

- **定義**: 記事 Markdown ファイルの Front Matter (`category` フィールド) で定義。
- **管理**: UI 上での作成・編集・削除機能はなし。新しいカテゴリは記事作成時に Front Matter で指定することで自動的に認識される。
- **アイコン**: アイコン表示が必要な場合、カテゴリ名とアイコンの対応表をコード内または設定ファイルで管理する。**アイコンライブラリとして `react-icons/si` を利用する。** 設定方法は設計で詳細化。
- **表示**: 記事一覧での表示、カテゴリ別記事一覧ページ。 (`/blog/categories/[category]`)

### 4.5 検索機能

- **対象**: 公開されている記事のタイトル、内容、カテゴリ、タグ。
- **方法**: ビルド時に全記事のインデックスを作成し、クライアントサイドで検索処理を行う方式を基本とする。**検索ライブラリとして `flexsearch` の利用を第一候補として検討する。**
- **絞り込み**: カテゴリ、タグによるフィルタリング。
- **結果表示**: 検索結果一覧ページ (SCR-04)。並べ替え（新着順）。

### 4.6 SEO対策

- **メタ情報**: Front Matter の情報等に基づき、各ページに応じた `title`, `description` メタタグを自動生成。
- **OGP**: Front Matter の情報等に基づき、主要な OGP タグを実装。
- **サイトマップ**: ビルド時に `sitemap.xml` を自動生成。
- **構造化データ**: 記事ページに `Article` スキーマ（JSON-LD形式）を実装。
- **パフォーマンス**: Next.js の SSG (Static Site Generation) を最大限活用し、高速な表示を実現。画像の最適化 (`next/image`)。

### 4.7 タグ機能

- **定義**: 記事 Markdown ファイルの Front Matter (`tags` フィールド) で定義。
- **管理**: UI 上での作成・編集・削除機能はなし。新しいタグは記事作成時に Front Matter で指定することで自動的に認識される。
- **表示**: 記事一覧での表示、タグ別記事一覧ページ。 (`/blog/tags/[tag]`)

### 5. 画面一覧

| 画面ID  | 画面名           | 説明                                                |
|---------|------------------|-----------------------------------------------------|
| SCR-01  | トップページ     | サイトのメインページ。最新記事、カテゴリ一覧などを表示 |
| SCR-02  | 記事一覧ページ   | 全記事またはカテゴリ/タグ別の記事一覧を表示         |
| SCR-03  | 記事詳細ページ   | 個別記事の内容、関連情報（カテゴリ、タグ）を表示       |
| SCR-04  | 検索結果ページ   | 検索条件に合致する記事一覧を表示                    |

## 📊 データ要件

- **コンテンツ**: Git リポジトリ内の Markdown ファイル (`.md`/`.mdx`) と画像ファイル。
    - **Markdown Front Matter**: `title`, `publishedAt`, `updatedAt` (任意), `status`, `excerpt` (任意), `coverImage` (任意), `category`, `tags` (任意)。

## 🔄 インタラクション

- **コンテンツ更新フロー**: 管理者がローカルで Markdown ファイルや画像ファイルを変更 -> `git commit` & `git push` -> Vercel が変更を検知し、サイトを再ビルド＆デプロイ -> 公開サイトに反映。
- **記事表示**: ビルド時またはリクエスト時に Markdown ファイルを読み込み、パースして HTML としてレンダリング。
- **カテゴリ/タグ集約**: ビルド時に全記事の Front Matter をスキャンし、カテゴリとタグの一覧を生成。

## ❓ 未解決の質問

- **検索機能の実装詳細**: `flexsearch` を利用する場合の、具体的なインデックス作成方法と検索UIの実装。
- **カテゴリ/タグのアイコン表示**: `react-icons/si` を使用し、カテゴリ名/タグ名とアイコンコンポーネントをどのようにマッピングするか（例: 設定ファイル、命名規則）。
- **ビルドパフォーマンス**: 記事数が増加した場合のビルド時間への影響と対策。 