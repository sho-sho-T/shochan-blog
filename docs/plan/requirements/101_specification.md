# 個人技術ブログ 要件定義書

## 📑 関連ドキュメント

- [技術スタック仕様書](../../003_teck_stack.md)
- [要件定義書作成ガイド](../rules/make-specification.md)
- [要件定義書索引](100_index.md) - ※後で作成する場合

## 📋 概要

個人の技術的な知見や学習内容を発信するためのブログシステム。記事の作成、管理、表示機能を提供する。

## 🎯 要求

- 管理者は記事の作成、編集、削除ができること。
- 記事はマークダウン形式で記述できること。
- 画像はSupabase Storageで管理し、記事編集時にアップロードできること。
- サイト全体の閲覧数と個別記事の閲覧数を表示できること。
- カテゴリの管理（作成・編集・削除、アイコン設定）ができること。
- キーワード、カテゴリ、タグで記事を検索できること。
- 基本的なSEO対策が施されていること。

## 📝 機能仕様

### 4.1 記事管理機能

- **権限**: 管理者のみアクセス可能
- **記事形式**: シンプルなマークダウン入力
- **記事情報**:
    - タイトル (必須)
    - 内容 (必須, マークダウン)
    - 抜粋（概要）
    - カバー画像 (任意, 画像管理機能と連携)
    - カテゴリ (必須, カテゴリ管理機能と連携)
    - タグ (任意, タグ管理機能と連携)
    - 公開状態（公開/非公開, デフォルト: 非公開）
    - 公開日時 (公開時に自動設定、手動変更も可能)
- **操作**:
    - 新規作成
    - 編集
    - 削除

### 4.2 画像管理機能

- **ストレージ**: Supabase Storage
- **操作**:
    - 記事編集画面からのアップロード
    - アップロード済み画像のプレビュー表示
    - アップロード済み画像の選択（再利用）
    - 不要な画像の削除
- **連携**: 記事管理機能（カバー画像、記事本文中の画像挿入）

### 4.3 アクセス解析機能

- **サイト全体**:
    - 総閲覧数を表示（例: フッターや管理画面）
- **個別記事**:
    - 記事詳細ページに閲覧数を表示
    - 閲覧数の記録
- **オプション**:
    - アクセス統計の可視化（管理画面でのグラフ表示など）
- **人気順**: 直近3ヶ月の閲覧数に基づいて計算

### 4.4 カテゴリ管理機能

- **権限**: 管理者のみアクセス可能
- **操作**:
    - 新規作成
    - 編集（カテゴリ名、アイコン）
    - 削除（**注意**: このカテゴリに属する記事も同時に削除される）
- **設定**:
    - カテゴリごとにアイコンを設定可能
- **表示**:
    - 記事一覧でカテゴリアイコンを表示
    - カテゴリ別の記事一覧ページへのリンク

### 4.5 検索機能

- **検索方法**:
    - ヘッダー等に検索ボックスを設置
    - キーワード入力による全文検索
- **絞り込み**:
    - カテゴリによるフィルタリング
    - タグによるフィルタリング
- **結果表示**:
    - 検索結果一覧ページ (SCR-04)
    - 並べ替えオプション（新着順、人気順（直近3ヶ月の閲覧数））

### 4.6 SEO対策

- **メタ情報**:
    - 各ページに応じた `title`, `description` メタタグの自動生成・設定
    - 記事ページでの個別設定
- **OGP**:
    - 主要なOGPタグ（`og:title`, `og:description`, `og:image`, `og:url`, `og:type`）の実装
- **サイトマップ**:
    - `sitemap.xml` の自動生成・更新
- **構造化データ**:
    - 記事ページに `Article` スキーマ（JSON-LD形式）を実装
- **パフォーマンス**:
    - Next.jsの機能（ISR/SSR/SSG, Image Optimization等）を活用した最適化

### 4.7 タグ管理機能

- **権限**: 管理者のみアクセス可能
- **操作**:
    - 新規作成
    - 編集 (タグ名)
    - 削除 (タグ自体を削除。記事との関連付けは解除されるが、記事は削除されない)
- **連携**: 記事管理機能（記事編集時にタグを選択・追加）

### 5. 画面一覧

| 画面ID  | 画面名             | 説明                                                     |
|---------|--------------------|----------------------------------------------------------|
| SCR-01  | トップページ       | サイトのメインページ。最新記事、人気記事、カテゴリ一覧を表示 |
| SCR-02  | 記事一覧ページ     | 全記事またはカテゴリ/タグ別の記事一覧を表示              |
| SCR-03  | 記事詳細ページ     | 個別記事の内容、関連情報（カテゴリ、タグ、閲覧数）を表示     |
| SCR-04  | 検索結果ページ     | 検索条件に合致する記事一覧を表示                         |
| SCR-05  | 管理者ログインページ | 管理者認証を行うページ                                     |
| SCR-06  | 管理画面トップ     | 管理機能へのナビゲーション、概要情報（総閲覧数など）を表示 |
| SCR-07  | 記事編集ページ     | 記事の新規作成・編集を行うシンプルなMarkdownエディタ       |
| SCR-08  | カテゴリ管理ページ | カテゴリの作成・編集・削除を行うインターフェース           |
| SCR-09  | タグ管理ページ     | タグの作成・編集・削除を行うインターフェース               |

## 📊 データ要件

- **記事データ**: title, content (markdown), excerpt, coverImageUrl, categoryId, tags (array), status (published/draft), publishedAt, createdAt, updatedAt, viewCount
- **カテゴリデータ**: id, name, iconUrl, createdAt, updatedAt
- **タグデータ**: id, name, createdAt, updatedAt
- **管理者ユーザー**: id, email, passwordHash
- **画像データ (Supabase Storage)**: URL, メタデータ (ファイル名、サイズ等)
- **記事とタグの中間テーブル**: articleId, tagId (多対多のリレーションシップ用)

## 🔄 インタラクション

- **記事作成/編集**: 画像管理機能と連携し、画像をアップロード・選択する。カテゴリ管理機能と連携し、カテゴリを選択する。タグ管理機能と連携し、タグを選択または新規作成する。
- **記事表示**: 記事データ、カテゴリデータ、タグデータ、閲覧数を取得して表示する。
- **カテゴリ管理**: カテゴリ削除時、関連する記事も削除される。
- **タグ管理**: タグ削除時、記事との関連付けのみ解除される。記事自体は削除されない。タグ編集時、そのタグが付けられた全ての記事に反映される。

## ❓ 未解決の質問

- 管理画面の具体的なデザインやレイアウトは？
    - **方針**: 特定のデザインは未定。添付された参考画像（Otete.dev のスクリーンショット）のような、ダークテーマでシンプルかつ機能的なレイアウトを目指す。コンポーネントライブラリ (shadcn-ui) を活用し、使いやすさを重視する。 