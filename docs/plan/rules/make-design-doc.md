# 設計方針書作成ガイド

このドキュメントでは、設計方針書作成のプロセスとベストプラクティスについて説明します。品質の高い設計方針書を作成することで、開発プロセスの効率化と成果物の品質向上を目指しています。

## 役割と責任

設計方針書担当者は以下の役割と責任を持ちます：

- web Front end エンジニアのプロフェッショナルとして機能する
- 既に存在する実装要件ドキュメント（1XX_specification.md）と関連code情報から、Juniorエンジニアが迷いなく開発できるような実装方針のDocumentを書く
- 不確実な部分があれば確認しながら、一緒に作り上げる
- 実装の詳細codeは書かずに、実装要件をどの実装方法で行うのがベストかという設計のみに注力する

## 設計方針書作成プロセス

### 実装要件から設計方針への展開

設計方針書担当者は、既存の要件定義書（1XX_specification.md）から設計方針書を作成するために以下の作業を行います：

- 既に存在する実装要件ドキュメントと関連code情報を参照する
- 仮に不確実な実装要件やぬけもれがある場合、確認を都度行う
- 実装要件を満たす複数の実装方法があった場合、候補を洗い出して、ベストな方法を提案する
- どの方法を選択するのか一緒に考え、実装方針の設計を行う
- 実装方針の選択があった場合は、必ず選択肢と最終的な選択理由を記述する

### 要件定義書との連携

- 実装方針の設計の精緻化に伴い、要件の変更/調整があった場合には、対応する`1XX_specification.md`も更新する
- 要件定義書は実装要求を詳細な実装要件にしたドキュメントであり、実装の詳細には触れない
- 実装の詳細は、`2XX_design-doc.md`に記述する

## 成果物と出力形式

設計方針書作成プロセスの成果物として以下を作成または更新します：

- **設計方針書**: `2XX_design-doc.md`（2XXは200番台の連番）

### ファイル命名規則
- 設計方針書は `2XX_design-doc.md` の形式で命名します（例: `201_design-doc.md`）
- 2XXは200番台から始まる連番で、設計方針書専用のナンバリングです
- 対応する要件定義書との関連は、下2桁の番号を揃えることで表します
  - 例：要件定義書が`101_specification.md`の場合、対応する設計方針書は`201_design-doc.md`
- 一つの設計方針書が500行を超える場合は、新しいファイルを作成します
  - この場合、`2XX-A_design-doc.md`、`2XX-B_design-doc.md`のように接尾辞を付けて区別します

### 複数ファイルの管理
- 設計方針書が複数のファイルに分かれる場合は、各ファイルの先頭に相互参照リンクを追加します
- 各ファイルの冒頭には、そのファイルが対象とする機能カテゴリを明記します
- 要件定義書(1XX)と設計方針書(2XX)の対応関係を明確にするため、参照リンクを追加します

- 最終的な出力はコピペしやすいよう、コードブロック内にマークダウン形式で提供する

## 設計方針書の構成

設計方針書は以下の構造に従って作成します：

```markdown
# [機能/ページ名] 設計方針書

## 📑 関連ドキュメント

- [対応する要件定義書へのリンク](1XX_specification.md)
- [関連する設計方針書へのリンク]
- [分割された設計方針書への参照]

## 📋 概要

[設計方針の目的と背景の簡潔な説明]

## 🔍 要件の分析

[要件定義書から抽出した主要な実装ポイント]

## 🛠 実装方針

### アーキテクチャ選択

[選択したアーキテクチャと選択理由]

### コンポーネント設計

[主要コンポーネントの責任範囲と相互関係]

### データフロー

[データの流れと状態管理の方針]

## 🔄 実装方法の選択肢と決定

[検討した実装方法の候補と最終決定]

### 選択肢1: [方法名]

[説明と評価]

### 選択肢2: [方法名]

[説明と評価]

### 決定: [選択した方法]

[選択理由と期待される効果]

## 📊 技術的制約と考慮事項

[実装時に考慮すべき技術的制約や注意点]

## ❓ 解決すべき技術的課題

[実装前に解決すべき技術的な疑問点]
```

## 設計方針書作成のポイント

1. **実装の詳細ではなく方針に集中**
   - 具体的なコードは書かず、実装の方向性と理由を示す
   - 実装者に適切な裁量を与える

2. **選択肢と決定理由を明確に**
   - 検討した複数の実装方法を明示する
   - 最終的な選択理由を具体的に説明する

3. **要件との整合性を確保**
   - 提案する実装方針が要件を満たすことを確認する
   - 要件に変更が必要な場合は明示的に示す

4. **技術的制約を考慮**
   - プロジェクトの技術スタックや制約条件を考慮した方針を示す
   - 実装時の潜在的な課題を予測して対応策を提案する

## ファイル管理のベストプラクティス

### 要件定義書との連携

1. **ドキュメント種別ごとのナンバリング**
   - 要件定義書: `1XX_specification.md`（例: `101_specification.md`）
   - 設計方針書: `2XX_design-doc.md`（例: `201_design-doc.md`）

2. **機能の対応関係**
   - 同じ機能に関するドキュメントは、種別が違っても下2桁の番号を揃える
   - 例：ユーザー認証機能の場合、要件定義書は`101_specification.md`、設計方針書は`201_design-doc.md`

3. **分割ファイルの命名**
   - 設計方針書を分割する必要がある場合は、接尾辞（A、B、C...）を付ける
   - 例：`201-A_design-doc.md`、`201-B_design-doc.md`

4. **相互参照管理**
   - 要件定義書と設計方針書の間で相互参照リンクを維持する
   - 分割された設計方針書間でも相互参照リンクを維持する

### 変更管理

1. **要件変更の反映**
   - 設計方針書の作成過程で要件の変更が必要になった場合は、対応する要件定義書も更新する
   - 変更履歴を明確に記録し、変更の理由を説明する

2. **バージョン管理**
   - 大幅な設計変更が必要な場合は、新しいバージョンとして作成する
   - 例：`201_design-doc_v2.md`

## 付録：具体的な例

### 単一機能の要件と設計の例

#### 101_specification.md と 201_design-doc.md
- 要件定義書（101_specification.md）がユーザー認証機能を定義
- 設計方針書（201_design-doc.md）がその実装方針を提供

```markdown
# ユーザー認証 設計方針書

## 📑 関連ドキュメント

- [ユーザー認証要件定義](101_specification.md)
- [権限管理設計方針](202_design-doc.md)

## 📋 概要

ユーザー認証機能の実装方針について定義します。
```

### 分割ファイルの例

大きな機能を複数の設計方針書に分割する場合：

#### 105_specification.md, 205-A_design-doc.md, 205-B_design-doc.md

```markdown
# 記事管理 設計方針書 (基本機能)

## 📑 関連ドキュメント

- [記事管理要件定義](105_specification.md)
- [記事管理設計方針 - カテゴリ管理](205-B_design-doc.md)

## 📋 概要

記事の基本機能（作成・編集・公開）の実装方針について定義します。
```

```markdown
# 記事管理 設計方針書 (カテゴリ管理)

## 📑 関連ドキュメント

- [記事管理要件定義](105_specification.md)
- [記事管理設計方針 - 基本機能](205-A_design-doc.md)

## 📋 概要

記事のカテゴリとタグ管理機能の実装方針について定義します。
```

### 索引ファイルとの連携

```markdown
# 設計方針書索引

このドキュメントは設計方針書の全体像と各ファイルの概要を示します。

## 設計方針書一覧

### 認証関連
- [ユーザー認証](201_design-doc.md) - JWT認証実装方針
- [権限管理](202_design-doc.md) - ロールベースの権限設計

### コンテンツ管理
- [記事管理 - 基本機能](205-A_design-doc.md) - CRUD操作とプレビュー
- [記事管理 - カテゴリ](205-B_design-doc.md) - カテゴリとタグの階層構造
```
