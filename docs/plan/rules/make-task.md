# タスク分割・整理ガイド

このドキュメントでは、実装要件定義書（`1XX_specification.md`）と設計方針書（`2XX_design-doc.md`）に基づき、開発タスクを分割・整理するプロセスとベストプラクティスについて説明します。

## 役割と責任

タスク分割担当者は以下の役割と責任を持ちます：

- web Front end エンジニアのプロフェッショナルとして機能する
- 既存の実装要件定義書と設計方針書から、Juniorエンジニアが迷いなく開発できるようにタスクを分割し、ドキュメントに整理する
- タスク分割において不明瞭な点があれば、質問を通じて明確化する

## タスク分割プロセス

### 入力ドキュメントの確認

- 以下のドキュメントを確認します。
    - `1XX_specification.md`
    - `2XX_design-doc.md`

### タスクの分割と整理

- 確認した実装要件と設計方針に基づき、開発タスクを分割・整理します。
- タスク分割は以下の原則に従います：
    - **動作保証**: 各タスク完了時に、実装部分の動作が保証できる単位で分割します。
        - 可能な限り自動テスト（ユニットテスト、ビジュアルリグレッションテスト等）で保証します。
        - 自動テストでの確認が難しい部分は、手動での確認手順を明記します。
    - **TDD**: テスト駆動開発（TDD）の原則に従ってタスクを進めます。詳細は関連ドキュメント (`testing.md`) を参照してください。
    - **完了基準**: 各タスクの完了時には、以下を確認し、エラーがないことを保証します。
        - `test` コマンドによるテストエラーがないこと。
        - `lint` コマンドによるリントエラーがないこと。
        - `build` コマンドによるコンパイルエラーがないこと。

## 関連ドキュメントの更新

- タスク分割の過程で、実装要件の変更・調整や設計方針の修正が必要になった場合は、以下のドキュメントも更新します。
    - `1XX_specification.md`: 実装要求を詳細な実装要件に落とし込んだドキュメントです。実装の詳細には触れません。
    - `2XX_design-doc.md`: 実装の方針に関するドキュメントです。実装方針に触れますが、詳細なコードは含めません。

## 成果物と出力形式

タスク分割プロセスの成果物として以下を作成または更新します：

- **タスク整理文書**: 作業中のブランチ名に対応するディレクトリに `3XX_task.md` を配置します。
  ```bash
  # 例: 現在のブランチが feature/add_plan-docs の場合
  context/feature/add_plan-docs/301_task.md
  ```

### ファイル命名規則
- タスク整理文書は `3XX_task.md` の形式で命名します（例: `301_task.md`）
- 3XXは300番台から始まる連番で、タスク文書専用のナンバリングです
- 対応する要件定義書と設計方針書との関連は文書内の参照リンクで明示します
- 一つのタスク文書が500行を超える場合は、新しいファイルを作成することを検討します
  - この場合、`3XX-A_task.md`、`3XX-B_task.md`のように接尾辞を付けて区別します

### 複数ファイルの管理
- タスク整理文書が複数のファイルに分かれる場合は、各ファイルの先頭に相互参照リンクを追加します
- 各ファイルの冒頭には、そのファイルが対象とする機能カテゴリを明記します
- 要件定義書(1XX)/設計方針書(2XX)とタスク整理文書(3XX)の対応関係を明確にするため、参照リンクを追加します

- **実装要件定義書（更新がある場合）**: 同じディレクトリの `1XX_specification.md` を更新します。
- **設計方針書（更新がある場合）**: 同じディレクトリの `2XX_design-doc.md` を更新します。

- 最終的な出力は、コピー＆ペーストしやすいように、コードブロック内にマークダウン形式で提供します。
- `1XX_specification.md` および `2XX_design-doc.md` に変更がない場合は、`3XX_task.md` のみを出力します。

## タスク整理文書 (`3XX_task.md`) の構成例

タスク整理文書は以下の構造に従って作成することを推奨します：

```markdown
# [機能/ページ名] タスク一覧

## 📑 関連ドキュメント

- [対応する要件定義書へのリンク](1XX_specification.md)
- [対応する設計方針書へのリンク](2XX_design-doc.md)
- [関連するタスク文書へのリンク]
- [分割されたタスク文書への参照]

## 📋 概要

[実装対象となる機能やページの概要]

## ✅ タスクリスト

### フェーズ1: [フェーズ名、例: 基本コンポーネント実装]

1.  **[タスク1]**
    - 概要: [タスクの簡単な説明]
    - 完了条件:
        - [ ] [具体的な完了条件1]
        - [ ] [具体的な完了条件2]
    - 動作確認:
        - [ ] `pnpm test:[app/package]` でテストが通ること
        - [ ] `pnpm lint:[app/package]` でエラーが出ないこと
        - [ ] Storybookで表示確認（該当する場合）
        - [ ] 手動確認: [確認手順] （自動テストでカバーできない場合）
    - メモ: [補足事項]

2.  **[タスク2]**
    - ... (同様の形式で記述)

### フェーズ2: [フェーズ名、例: データ連携]

3.  **[タスク3]**
    - ...

## ❓ 未解決の課題・確認事項

- [タスクを進める上での懸念点や確認が必要な事項]

## 🔗 関連ドキュメント

- 実装要件: [1XX_specification.mdへのリンク](1XX_specification.md)
- 設計方針: [2XX_design-doc.mdへのリンク](2XX_design-doc.md)
```

## ファイル管理のベストプラクティス

### 要件定義書・設計方針書との連携

1. **ドキュメント種別ごとのナンバリング**
   - 要件定義書: `1XX_specification.md`（例: `101_specification.md`）
   - 設計方針書: `2XX_design-doc.md`（例: `201_design-doc.md`）
   - タスク文書: `3XX_task.md`（例: `301_task.md`）

2. **機能の対応関係**
   - 同じ機能に関するドキュメントは、種別が違っても下2桁の番号を揃えることを推奨します
   - 例：ユーザー認証機能であれば、`101_specification.md`、`201_design-doc.md`、`301_task.md`

3. **分割ファイルの命名**
   - タスク文書を分割する必要がある場合は、接尾辞（A、B、Cなど）を付けます
   - 例：`301-A_task.md`、`301-B_task.md`

4. **相互参照の管理**
   - 要件定義書・設計方針書とタスク文書の間で相互参照リンクを維持します
   - 分割されたタスク文書間でも相互参照リンクを維持します

### 複合タスクの扱い

1. **複数の機能にまたがるタスク**
   - 複数の機能にまたがるタスクの場合は、最も関連性の高い機能の番号を使用します
   - 全く新しい領域の場合は、新しい番号を割り当てます

2. **共通基盤的なタスク**
   - 複数の機能の基盤となるタスクは、独立した番号を割り当てることを検討します
   - 例：共通コンポーネント、ユーティリティ関数など

## 付録：具体的な例

### 単一機能のタスク例

#### 101_specification.md, 201_design-doc.md, 301_task.md
- 要件定義書（101_specification.md）がユーザー認証機能を定義
- 設計方針書（201_design-doc.md）がその実装方針を提供
- タスク文書（301_task.md）が実際の実装タスクを整理

```markdown
# ユーザー認証 タスク一覧

## 📑 関連ドキュメント

- [ユーザー認証要件定義](101_specification.md)
- [ユーザー認証設計方針](201_design-doc.md)

## 📋 概要

ユーザーのログイン、登録、パスワードリセットなどの認証機能の実装タスクを整理します。
```

### 分割タスクの例

大きな機能を複数のタスク文書に分割する場合：

#### 105_specification.md, 205_design-doc.md, 305-A_task.md, 305-B_task.md

```markdown
# 記事管理 タスク一覧 (基本機能)

## 📑 関連ドキュメント

- [記事管理要件定義](105_specification.md)
- [記事管理設計方針](205_design-doc.md)
- [記事管理タスク - カテゴリ管理](305-B_task.md)

## 📋 概要

記事の基本機能（作成・編集・公開）の実装タスクを整理します。
```

```markdown
# 記事管理 タスク一覧 (カテゴリ管理)

## 📑 関連ドキュメント

- [記事管理要件定義](105_specification.md)
- [記事管理設計方針](205_design-doc.md)
- [記事管理タスク - 基本機能](305-A_task.md)

## 📋 概要

記事のカテゴリとタグ管理機能の実装タスクを整理します。
```

### 複合タスクの例

複数の機能に関連するタスク：

#### 320_task.md

```markdown
# 共通コンポーネント タスク一覧

## 📑 関連ドキュメント

- [UI要件定義](110_specification.md)
- [デザインシステム設計](210_design-doc.md)
- [記事管理要件](105_specification.md)

## 📋 概要

複数の機能で使用される共通コンポーネントの実装タスクを整理します。